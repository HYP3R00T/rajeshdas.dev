---
import { getCollection } from "astro:content";
import { Icon } from "astro-icon/components";

// Get all projects, sorted by order, filter drafts
const allProjects = await getCollection("projects");
const projects = allProjects
  .filter((p) => !p.data.draft)
  .sort((a, b) => (a.data.order || 999) - (b.data.order || 999));

// Icons mapping for projects
const iconNames = [
  "github", // TODO: Add terminal.svg icon
  "kubernetes",
  "arrow-up",
  "download",
  "github", // TODO: Add code.svg icon
  "github", // TODO: Add lock.svg icon
];
---

<section class="stripe-pattern relative bg-black px-6 py-32 md:px-12">
  <div class="mx-auto max-w-350">
    <div class="mb-20">
      <div class="text-section-label mb-4">Selected Work</div>
      <h2 class="text-section-heading mb-8 text-white">PROJECTS</h2>
      <p
        class="text-foreground-1 max-w-2xl text-sm tracking-wide uppercase md:text-base"
      >
        Recent projects and tools I've built to solve real-world DevOps
        challenges
      </p>
    </div>

    <div class="bg-border p-px">
      <div class="bg-border grid gap-px md:grid-cols-2">
        {
          projects.map((project, index) => (
            <div class="group hover:bg-background-hover bg-black p-8 transition-colors md:p-12">
              <div class="mb-8 flex items-start justify-between">
                <div class="border-border-strong border p-4">
                  <Icon
                    name={iconNames[index] || iconNames[0]}
                    class="h-8 w-8 text-white"
                  />
                </div>
                <div class="text-foreground-3 text-sm">
                  {String(index + 1).padStart(2, "0")}
                </div>
              </div>

              <h3
                class="mb-4 text-2xl tracking-tight text-white uppercase md:text-3xl"
                style="font-family: 'Space Grotesk', sans-serif; font-weight: 700;"
              >
                {project.data.title}
              </h3>

              <p class="text-foreground-1 mb-6 text-sm leading-relaxed">
                {project.data.description}
              </p>

              <div class="text-foreground-2 text-xs tracking-wide">
                {project.data.technologies.join(" â€¢ ")}
              </div>
            </div>
          ))
        }
      </div>
    </div>
  </div>
</section>
