---
import { Icon } from "astro-icon/components";
import Bar from "@/assets/barcode.svg";
import FeaturedCertificationCard from "./FeaturedCertificationCard.astro";
import CertificationListItem from "./CertificationListItem.astro";
import certificationsData from "@data/certifications.json";

const certifications = [...certificationsData].sort((a, b) => {
  if (a.pinned === b.pinned) return 0;
  return a.pinned ? -1 : 1;
});

const featuredCerts = certifications.filter((cert) => cert.pinned);
const additionalCerts = certifications.filter((cert) => !cert.pinned);
---

<section class="w-full">
  <div class="col flex w-full flex-col gap-6">
    <div class="flex flex-row items-center justify-between">
      <h2 class="text-text-default text-3xl font-bold">Certifications</h2>
      <div class="flex items-center justify-center opacity-30">
        <Bar />
      </div>
    </div>
    <div class="space-y-4">
      <p class="text-text-subtle text-sm">
        The official stamps of approval proving I can deploy things without
        setting everything on fire ðŸ”¥
      </p>
      {
        featuredCerts.length > 0 && (
          <div class="space-y-3">
            <h3 class="text-text-default flex items-center gap-2 text-lg font-semibold">
              <Icon name="github" class="text-cyan h-5 w-5" />
              Featured Certifications
            </h3>
            <div class="grid grid-cols-1 gap-4 md:grid-cols-2">
              {featuredCerts.map((cert) => (
                <FeaturedCertificationCard
                  title={cert.name}
                  provider={cert.provider}
                  providerLogo={cert.issuer}
                  badgeImage={cert.credly}
                  date={cert.acquired_date}
                  credlyBadgeUrl={cert.credly}
                  certificateUrl={cert.links?.[0] || ""}
                />
              ))}
            </div>
          </div>
        )
      }
      {
        additionalCerts.length > 0 && (
          <div class="space-y-3">
            <h3 class="text-text-default mt-6 flex items-center gap-2 text-lg font-semibold">
              <Icon name="github" class="text-cyan h-5 w-5" />
              Additional Certifications
            </h3>
            <div class="box-tr-lg bg-content p-4">
              <div class="space-y-3">
                {additionalCerts.map((cert, index) => (
                  <CertificationListItem
                    title={cert.name}
                    provider={cert.provider}
                    providerLogo={cert.issuer}
                    badgeImage={cert.credly}
                    date={cert.acquired_date}
                    credlyBadgeUrl={cert.credly}
                    certificateUrl={cert.links?.[0] || ""}
                    showBorder={index !== 0}
                  />
                ))}
              </div>
            </div>
          </div>
        )
      }
    </div>
  </div>
</section>
