---
import { Icon } from "astro-icon/components";
import Button from "@/components/ui/Button.astro";
import { formatMonthYearRange } from "@/lib/utils";

interface Props {
  project: {
    data: {
      icon?: string;
      title: string;
      description: string;
      technologies: string[];
      startDate?: Date;
      endDate?: Date;
      sourceRepo?: string;
      website?: string;
    };
  };
  index: number;
}

const { project, index } = Astro.props;
const projectDates = formatMonthYearRange(
  project.data.startDate,
  project.data.endDate,
);
const showLinks = Boolean(project.data.sourceRepo || project.data.website);
---

<div
  class="group border-border hover:bg-background-1/50 bg-background-0 relative border p-8 transition-all hover:z-10 md:p-12"
  style="margin-right: -1px; margin-bottom: -1px;"
>
  <div class="mb-8 flex items-start justify-between">
    <Button as="div" variant="outline" size="icon-lg">
      <Icon
        name={project.data.icon || "github"}
        class="text-foreground-0 size-6"
      />
    </Button>
    <div class="text-foreground-3 text-sm">
      {String(index + 1).padStart(2, "0")}
    </div>
  </div>

  <h3
    class="text-foreground-0 font-display mb-4 text-2xl tracking-tight uppercase md:text-3xl"
  >
    {project.data.title}
  </h3>

  <p class="text-foreground-1 mb-6 text-sm leading-relaxed">
    {project.data.description}
  </p>

  {
    projectDates && (
      <div class="text-foreground-2 mb-4 text-xs tracking-wide">
        {projectDates}
      </div>
    )
  }

  {
    showLinks && (
      <div class="mb-4 flex flex-wrap gap-2">
        {project.data.sourceRepo && (
          <Button
            as="a"
            href={project.data.sourceRepo}
            target="_blank"
            rel="noreferrer"
            variant="outline"
            size="sm"
          >
            Source
          </Button>
        )}
        {project.data.website && (
          <Button
            as="a"
            href={project.data.website}
            target="_blank"
            rel="noreferrer"
            variant="outline"
            size="sm"
          >
            Website
          </Button>
        )}
      </div>
    )
  }

  <div class="text-foreground-2 text-xs tracking-wide">
    {project.data.technologies.join(" â€¢ ")}
  </div>
</div>
