---
import { SITE, navItems } from "@data/config";
import Button from "@/components/ui/Button.astro";
---

<header class="bg-background-0 border-border sticky top-0 z-50 border-b">
  <div class="mx-auto flex max-w-7xl items-center justify-between px-4 py-3">
    <a href="/" class="flex items-center gap-3">
      <span class="text-lg font-semibold">{SITE.title}</span>
    </a>

    <!-- Desktop nav -->
    <nav class="hidden items-center gap-4 md:flex">
      {
        navItems.map((item) =>
          item.special ? (
            <Button
              href={item.href}
              variant="accent"
              target={item.blank ? "_blank" : undefined}
              rel={item.blank ? "noopener noreferrer" : undefined}
            >
              {item.label}
            </Button>
          ) : (
            <Button
              href={item.href}
              variant="default"
              target={item.blank ? "_blank" : undefined}
              rel={item.blank ? "noopener noreferrer" : undefined}
              class="hover:bg-background-2 rounded px-2 py-1 text-sm font-medium"
            >
              {item.label}
            </Button>
          )
        )
      }
    </nav>

    <!-- Mobile toggle -->
    <div class="md:hidden">
      <button
        id="nav-toggle"
        aria-controls="mobile-menu"
        aria-expanded="false"
        class="hover:bg-background-2 focus-visible:ring-accent inline-flex items-center justify-center rounded-md p-2 focus:outline-none focus-visible:ring-2"
        aria-label="Toggle navigation"
      >
        <!-- hamburger -->
        <svg
          id="icon-open"
          class="h-6 w-6"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          xmlns="http://www.w3.org/2000/svg"
          ><path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M4 6h16M4 12h16M4 18h16"></path></svg
        >
        <!-- close (hidden by default) -->
        <svg
          id="icon-close"
          class="hidden h-6 w-6"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          xmlns="http://www.w3.org/2000/svg"
          ><path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M6 18L18 6M6 6l12 12"></path></svg
        >
      </button>
    </div>
  </div>

  <!-- Mobile menu -->
  <div id="mobile-menu" class="border-border hidden border-t md:hidden">
    <div class="flex flex-col gap-2 px-4 py-3">
      {
        navItems.map((item) =>
          item.special ? (
            <Button
              href={item.href}
              variant="accent"
              size="default"
              target={item.blank ? "_blank" : undefined}
              rel={item.blank ? "noopener noreferrer" : undefined}
              class="w-full text-center"
            >
              {item.label}
            </Button>
          ) : (
            <a
              href={item.href}
              class="hover:bg-background-2 block rounded px-3 py-2 text-sm font-medium"
              target={item.blank ? "_blank" : undefined}
              rel={item.blank ? "noopener noreferrer" : undefined}
            >
              {item.label}
            </a>
          )
        )
      }
    </div>
  </div>

  <script>
    {
      `(function(){
      const btn = document.getElementById('nav-toggle');
      const menu = document.getElementById('mobile-menu');
      const iconOpen = document.getElementById('icon-open');
      const iconClose = document.getElementById('icon-close');

      if (!btn || !menu) return;

      btn.addEventListener('click', function(){
        const expanded = this.getAttribute('aria-expanded') === 'true';
        this.setAttribute('aria-expanded', String(!expanded));
        menu.classList.toggle('hidden');
        iconOpen.classList.toggle('hidden');
        iconClose.classList.toggle('hidden');
      });
    })()`;
    }
  </script>
</header>
