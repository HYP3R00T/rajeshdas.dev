---
import { getCollection } from "astro:content";
import BlogPostCard from "@/components/BlogPostCard.astro";

// Get all posts, filter drafts, sort by date (newest first)
const allPosts = await getCollection("posts");
const posts = allPosts
  .filter((p) => !p.data.draft)
  .sort((a, b) => b.data.pubDatetime.getTime() - a.data.pubDatetime.getTime())
  .slice(0, 6);
---

<section class="relative bg-black px-6 py-32 md:px-12">
  <div class="mx-auto max-w-350">
    <div class="mb-20">
      <div class="text-section-label mb-4">Insights</div>
      <h2 class="text-section-heading mb-8 text-white">ARTICLES</h2>
      <p
        class="max-w-2xl text-sm tracking-wide text-white/60 uppercase md:text-base"
      >
        Thoughts and learnings on DevOps, infrastructure, and automation
      </p>
    </div>

    <div class="space-y-0 border-t border-white/10">
      {posts.map((post, index) => <BlogPostCard post={post} index={index} />)}
    </div>

    <div class="mt-12 text-center">
      <a
        href="/post/"
        class="inline-block border border-white bg-transparent px-8 py-4 text-xs tracking-wider text-white uppercase transition-colors hover:bg-white hover:text-black"
      >
        View All Articles
      </a>
    </div>
  </div>
</section>
