---
import { getCollection } from "astro:content";
import Badge from "@/components/ui/Badge.astro";
import ProjectCard from "@/components/project/ProjectCard.astro";
import Button from "@/components/ui/Button.astro";

// Get all projects, sorted by order, filter drafts
const allProjects = await getCollection("projects");
const projects = allProjects
  .filter((p) => !p.data.draft)
  .sort((a, b) => (a.data.order || 999) - (b.data.order || 999));
---

<section
  class="stripe-pattern relative flex items-center justify-center px-6 py-32 md:px-12"
>
  <div class="mx-auto w-full max-w-7xl">
    <!-- Badge -->
    <Badge variant="outline">Selected Work</Badge>
    <h1 class="text-section-heading my-8">
      <div>PROJECTS</div>
    </h1>

    <p
      class="text-foreground-muted max-w-2xl space-y-6 text-base leading-relaxed md:text-lg"
    >
      Recent projects and tools I've built to solve real-world DevOps challenges
    </p>

    <div class="mt-8 grid md:grid-cols-2">
      {
        projects.map((project, index) => (
          <ProjectCard project={project} index={index} />
        ))
      }
    </div>

    <div class="mt-12 text-center">
      <a href="/project/">
        <Button size="lg" class="uppercase">View All Projects</Button>
      </a>
    </div>
  </div>
</section>
