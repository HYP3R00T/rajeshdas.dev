---
import { getCollection } from "astro:content";
import BlogPostCard from "@/components/homepage/BlogPostCard.astro";

// Get all posts, filter drafts, sort by date (newest first)
const allPosts = await getCollection("posts");
const posts = allPosts
  .filter((p) => !p.data.draft)
  .sort((a, b) => b.data.pubDatetime.getTime() - a.data.pubDatetime.getTime())
  .slice(0, 6);
---

<section class="relative bg-black px-6 py-32 md:px-12">
  <div class="mx-auto max-w-7xl">
    <div class="mb-20">
      <div class="text-section-label mb-4">Insights</div>
      <h2 class="text-section-heading text-foreground-0 mb-8">ARTICLES</h2>
      <p
        class="text-foreground-1 max-w-2xl text-sm tracking-wide uppercase md:text-base"
      >
        Thoughts and learnings on DevOps, infrastructure, and automation
      </p>
    </div>

    <div class="border-border space-y-0 border-t">
      {posts.map((post, index) => <BlogPostCard post={post} index={index} />)}
    </div>

    <div class="mt-12 text-center">
      <a
        href="/post/"
        class="border-foreground-0 text-foreground-0 hover:bg-foreground-0 inline-block border bg-transparent px-8 py-4 text-xs tracking-wider uppercase transition-colors hover:text-black"
      >
        View All Articles
      </a>
    </div>
  </div>
</section>
