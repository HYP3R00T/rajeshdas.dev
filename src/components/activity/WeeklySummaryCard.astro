---
import ActivityAccordion from "@/components/activity/ActivityAccordion.astro";
import { formatWeekRange } from "@/lib/github-activity";

interface Props {
  weekStart: Date;
  weekEnd: Date;
  events: any[];
  projectCounts: Record<string, number>;
}

const { weekStart, weekEnd, events, projectCounts } = Astro.props;
const weekRange = formatWeekRange(weekStart, weekEnd);
const totalActivities = events.length;
const projectEntries = Object.entries(projectCounts).sort(
  (a, b) => b[1] - a[1]
);
const accordionId = `week-${weekStart.getTime()}`;
---

<details data-week-card>
  <summary>
    <h3>{weekRange}</h3>
    <div>
      {
        projectEntries.map(([project, count]) => (
          <span>
            {project}: {count} {count === 1 ? "activity" : "activities"}
          </span>
        ))
      }
    </div>
    <span
      >{totalActivities} total {
        totalActivities === 1 ? "activity" : "activities"
      }</span
    >
  </summary>
  <div>
    {events.map((event) => <ActivityAccordion event={event} />)}
  </div>
</details>
